---
- name: Install NFS client
  package:
    name: nfs-utils
    state: present
  tags:
    - install
  when: ansible_distribution == 'CentOS'

- name: Install NFS client
  package:
    name: nfs-common
    state: present
  tags:
    - install
  when: ansible_distribution == 'Ubuntu'

- name: Turn on NFS client
  service:
    name: rpcbind
    state: started
    enabled: yes
  tags:
    - install

- name: Ensure mount dir exists
  file:
    path: "{{ nfs_mount }}"
    state: directory
  tags:
    - directory

- name: Make the mount
  mount:
    name: "{{ nfs_mount }}"
    src: "{{ nfs_server }}:/{{ nfs_dir }}"
    fstype: nfs
    state: mounted
    opts: "{{ nfs_options }}"
  tags:
    - directory
